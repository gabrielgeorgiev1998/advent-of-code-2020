input_str = """neneeenenesweneswneesewenenwneew
eswswenweeseneseswwsenewsenw
seeweswwneswnwwwenwwwwwnenwwsesw
swsweseseseswswsenwswseswswsese
eseseseswsenweseseneseswnwneeewww
sweeeeeenweseenesweee
nwnwsewenwwnwnwsenwwnwseswnwnw
swswswwwswweswswswswswenenesesewwwe
swnwenenesenwsewswswseeeswnwwnewwsese
senwweewnwweswnenwwsw
ewneswswsweenwwnwsenwswnewsenwnwsw
nenenwwneenwnwnwwnesewsenenwnwnenwnw
nwnwwsenwwnwnwnwnwwnwnwewwnw
wnwnwnwnwseswwnwnwesewsenwnwnwnwnenew
seswewwneweswnwnwswwsw
neswesenenenewwswnenwnenenenwnenenenese
nwwswsenwnenwnesenwnwsenwnwnwwnwsenenwse
senwswwswwnweswswneswswwswnweswseswew
neeeeswnweswseeeeeneeeeenwwnene
nwnewnwnwnwswnewwsewnwwseenenwnww
eeseeeeeswneenwewee
neseseseeenwwseseeseneswnenwsewswse
wswswnwnwwswswneswwweeswswswwww
swnwnwneswswseswseswswswswswnwseswsesenesw
swneesenwnwnwwnwnwnenwnwnwnwnewnwsese
wswswswewnewnewsenewnwswseswswwse
swenwnwnwnenwnenwnwswnenenwswwnenwsenw
ewnenwnwweenwneesewnwwwwnwswse
eeewnweneneeesweesweeeneeee
nenwnwnwnwswwnwsewnwswswenwweswenw
senenenenenenwneneewnenenene
neneeneswnesewneneneeneneeenenenwe
nwswenwseswnwswenwnwnewnwneww
wnewwwweswwsww
seseswsewesesenesesewseewseseenenwe
neneseswnesenewwenenwneneneneneenew
swswswswwsweswseswsewwneswswswswneswswsw
sesenesesesenwsesesesenwsewnw
nenenenenenewnwswnwnenwsenesenwneswwne
swwnewweewwwwnwswnewwweswew
swnwwswesenewwwswwswwweseswswnesw
weeseseseneseseewwseseseseseseesese
nwenenenwwnenenenenwneneneseswnenwenesw
nwsewswswwswsweswnwwwnwswswsew
nwewnwwwewnwwnwnwwnwswwnwwsewnw
eesesesesesesewseseewneseesesesesenw
nwwenwweswnwswenwnw
sewseswswneneswnwenwneeswwnwwesenw
eseswwnwnwwenewneswnwsweenwseswne
wsewwswnwnwewnewswwwwswseswnew
eswnenwnwnenwswnenwnwnwnenwnwnwnenwsewne
neneewswnenenenenene
nwseeseseesesesesesesese
eenweneeeswswseeseeneesese
sewneeneneswseeewnwswsenewswenwwenw
nwwwweswnenwsenwwswnwwnwwwnwwnew
nwewwneswnwwwnwswswsesweswswwseww
neseswseweseeswsenwsesesesesw
nwswswseswswseeswswseswnewneseswswwsw
eweseeswseeeeseneenwenweeee
nesewwwwneeseweswwseneeseseswseswsw
nwswnwnewnewneeenwneeswwnwse
swwnwsesewneneeneenwseswseswnww
nwnwnwnwsenwnwnwnwnwnwnwnw
wwnewnwsesewwwwwwnwseewsenenew
swswswswenwswseswsweeswnwswswswswswswswnw
nwnwseeswnwnwswnenwwnwnewnwnwwnwnw
wnenenesesenwnwwnwsenenesewnewnenee
senwswnwnwwenenwnenwnenesewswenewnene
neseseeseneswswswswswwwswswnwswwsenesw
neswwsesenwnwnwneswseseseseswnesenwsese
eeweesenesweenweeneenwneeswse
wwnewswsenwnwsesenwswseneeswswseswnese
wnwsewnwnwnenwnwnwnwwnwnwwww
wwswswewwwwwwswwwwnewnwnenw
eeneseswswnewneneneenenenenenenenew
wswwnwswwswneneneswnwnwnwswseneneswsenene
nwswswewswsewswsewswsenweswswneswnwsw
wwwwesewnwnewwwnewwwwsese
nwnesenwnwnwnwswswnwwswwnwnwwwwneeenw
swseseswenwswswnwswwnenesenesesesesesese
nesewswswswsewswswnwswwswwswsw
wnwwwnwnwnwnwsewsenwsewwwwwww
wwwwwwwwswwswwwewwnw
swseseseseeswsesesenwseseswseswwsenwse
sweeeseeswnwenwneeenwneswenwneee
nwswseswswswswwsweswnesesweswswswseswse
nwnwenwnwnwnwnwswnwwnwnwwnenw
wseewnwnwnwenewnenenesenewnenwnenwne
nwsweswswswswswswswswsw
swswwswwswswswswnenewenwewweswnw
nwseeswnwnwseseseswneseswseseseenewsw
wseswseseesenweeeseeeewnwenene
newnenenwswnwnenenwneneseneneneenenesenw
wnwnwswseenwnwnwnwenwwwnwnenwnwswne
esesesesewneseswswsewswseswswneswsesesw
wsewwwnewswwnenenwnwwnwwnwnwwwsew
wsenwenwnwnwewwsesenwwwwnwnwnwnew
nwnwnenesenenenwnenewnenenwneneswswnene
eseneneewneneneeneeneneee
nenenenwnwseswswnwwnwnwwesenwsenewswne
neenwnwnenenwnwnwwnwnenwnwnwwnwswsenw
swwwswwswswwnwwwnenwseswswwseswsenw
nwsewneswnwesweeswnwwwnweswnwne
neswsewswseswseswswswneswseswneseseswsww
wsewwwnwnenwnwewwseenwwwwswnw
neseseswseswwswswswnenwsesewswswswswsw
swwsweswneseswswwswswswswweswwsw
nenwneneswneeneenene
eneweneseneeneeswswswenenesenenew
swseeseswswesenwsesenwswnwnwseeesenwswsw
nenenwnenwwwnenenweneneneseneswnenenene
neneenenwswswseswwwnweswnenesesewnewse
neneseneneseneenenenewswneeenenewnene
swsweesenesenenenwnwnwswsweneseenww
swnewwnwsewseswewsewsesenwneewnww
enenewnenenenwnenenenw
seseesesewwseseseseseswswseesesenese
eeenwneeeewneneeeeewswneneee
eswnwenweesenwseeswsweenwsenwnwesw
eesweeeneneeneeeeewnweeewe
seswswseseswswswsene
newswnewswwwneswwwse
neeswnenwewnwnesewsweneeswnwenesww
eswwwwwwswnesewwwnewwnwwww
ewsesenwseswsesenwsesesewesenwsenenese
nenwnewswneneneneeeneneseneneneenee
wwseseeeenwnwweseneewnweeeewsw
nwneswnwnwnwwwnwseenwnwnwenenwnw
swswswswswneswenwwweswswsw
swenwwwnwnewswnenwneswnwesweswwe
neswseenwseseeenwsesesew
seseeesesenwnwseeseseseswnesese
sweeeseseenwseeweesee
swneswsweswnewwswseswswsw
nwwwewsewwwwwwwwewswswnewsw
nenenewneswsenenenenesenenenenenenenwneenw
sewwwnesewswwnwwwwswewswwswew
swswseswnwnwswswswswswswnwseswenwseswswsw
nwnwnwnwnwnwnwnwnenwnwsenw
nenwwewnwwsewnewwnwsewwwewseswe
seseseswweewnwneneseseseesewsesesw
swswesenewswswswwewswsesweswsw
seseneneswwsewneeenwenenwseenwsee
nenwenwwneewnwneswnwnenwseswnwenwnwnw
sweswswswseswswswseseswseswwnesesesenw
nweeesweeeeneseeseeenwenwwe
sweewneneeeseeewswneeenwneenene
swsewseseenwsenesewseseseswswseswnese
wwwswseseswwnwwnwnenenwwswnwsenesene
seswswswseeseswseseseswnwsenwseswswsesene
nenwesenwswneneseeewsesesweeseeswse
nwseswswnwseeswnwswsenwnwnenwnenwnwnenwnw
neswnenwweesenwneswwneneswnwenenesw
nwneswnesesenwswenwsesewewsweewsw
neseeenenenewnenenweswew
eenweesweewneneseneeswee
weesenwsweenenenwswenenwneswenee
nwswswsweseswwsweswswswswnwswswswswsw
esweweseeeeseneeenweeeeee
swneswswswwswnenwewswenwswswwnew
eesweswnwseeeeeeeeneseeenwsee
senwwswnwnwnwnwnwnenwnwnwnwnwwnenenwnese
swwseeswswnwnenesewnenwsenweeeene
enenwnesenenenenwnenewneneneewswswwne
nwwneseseeseeseeseseeseseeseswnwsese
sewwswsewnwwswnwnwnewenweneswesw
eneeneeneeneewneeeeeeenwsesw
wwenwwnesenwnwnwwww
nwneneswnesenenenenwnwnenenenwnene
sweneseseswewnwswwneneneneseneesenwnw
nwewenwnwwwnwnenwsesenwnenesenwnwwwnw
nwenwnwswsenwnwnwnenwnwnwnwnwwesenenw
swswwnewweweswswnwswsenesewwwnww
nenewneswnenenweenenenwswsenene
swswswwswswswswswswswswswne
eeswswenwswneenwenweseenwnweeese
swnwnwnwwwsewnwnenwwwnww
wswwwenenwwwweswseswnwswweswsw
enewneneweseeswswenewnenwwnesene
swsenesweswswswswwswswswseseseswwsw
nwwseswnwsenwsenenwwnwnwneewwwwww
wwsesesenwnwnenesenwenenwswneneenesw
seseneweseeswseseneeseseesenwesese
nwnwwswwwweenwwnwwswsewwneww
eneneneeneswnenweneswenewneeseenenew
eseewneesenewesenwsewewwwsee
nwnwnwenenenwenwnwnwsenwnwnwswnewnenwne
neseeeesewneseseweeseseswseseesese
newwnwswwewneswseewsesweswneswwse
seseseseseeseenwseeenwsesesesese
eseswnesewseswswswsenwwswseswneswsee
eeseseseneeeeeseeeseeew
nwesweeneenwnwseneeeneeeneneneswse
swswswswseseswnwneswswseswsewse
senwnweswwnwwnwweseenwswsenwnwwse
wneneneenenesenewnwswswenwnene
eswseswneseseneseseeeeeewsenenwnew
sewseeeeenwseese
sesenwnwseseseswseseswswswseesenesesesenwse
nwwneewseswneeeneneneseenenwewneese
wwwswwnewwneswwwwwsewwwsw
seswwwwneswneswwneswswswswswseww
eewneenwsweseseweeeeneneneneesw
swswsewswswwswswnewwswsww
nwnwwswnenwwnwnenwswnwnwwsenwseeswwnw
swswsenwnewseeswseseneneswsewnwsesesenwsw
senwnwnwnwswneswnwenwnwwnesweswswnwnenw
neenenewswnwswnwsewwewswsenwnwwsw
senwnewnewnwwnwwnwseseswwnw
seeseseeneswneeswnenwwswswwswnwswwe
seswenweeneeneneneeneneneee
nwwnwwenwwwwwwwnw
swswswswwswwswwswsenenwsewnewneswswne
newswnwnwswnwenwwnenwnwnwwwwsewnwnw
eneewenweeeweeseenwseneeeswse
seseseswenwseseweseseenwnee
wnwwnenwswnwnwweeeswsw
senesesenwswseseseenwseswseswswseswsesw
seseseseseseseseseseseseenwsese
seenwnwnwswsewweeweseeneesewswene
wwwseswsesenwnwnenenwse
nwwewnwnwwneswnwwnwnwnwwnwewswne
neewneneseneneswnene
wswwswnwwwswwwewswswsww
wswwneswwswnwwnwnewseswsewswenwsw
ewnwwwwswwnwesweswswwsw
wswnwnwwnenwnewwsesewwseenewswenew
wswwnenwwswnenenwnenenenenweswseseswe
nesesenwswsweeswewwswneeneeeee
nwswwwnewwwwwwneewnwsewsewsew
nwwweswwswwwnwneswnwswenwnwneew
nwnwswnwswenenenwnwwnwnenwnenenweew
neswnwneseeneneenewswwnwnweseneene
nwswswwwwseeswnwswwsweswwnwseswww
neneseneswsesewenwseswneneswnenwwenew
neneneeneneneseneeneseneww
sweenenwenweeenesweeeenwesee
seseseseseseneesesesesesesesew
senesweewneeswenwseswseseeeesee
nesesenwwswnwnwwnewsenenwswnwnenwsee
neseewnwenenwwnewnenwnwsenwnwswswnwnw
eswnenenwswnewsweseswseewsesenwsee
enweeswenwewsweeeneenweeseesee
senwswswwswwswswwswswswswseswswswneswne
sweswwnwewseneeeenenewenweee
newnenwnwswwseseseesenwsese
enweeswseenwneeenenesweeneswenewsw
nwnwnwnwnwswenwnwnwnwnwnweswnwnwnwnwnw
nenenenweneswnesenwneswneneneneeneese
seseeenwswnweeeewswseeeswwnwsenw
esenwsewseseesewneseeseseseeeenese
seewnwsesesenwesesesesewneeeseee
eneseneewneneseweeneneeeneeee
nwwnwenwswsenwnwnwnwnwwnwswwnwnwnwnew
wnewwwwwwnwwwswnwww
wnwenwsenwswnwnwnwwnenwnwnw
eeneneswnwwneneswnwneeeneneneneewne
wsewnwwwwewwwwwwwsenwwnwwe
wwwseeseswsewsewewneswnwsewnenenw
seseneswsewneswswseswseswswswseneswsesesw
nwnwnwsenenweeneneeneswswneswneseeesw
eswseswwnwswseswswswswneenwswseswsese
eenewseneeeseneneeswwneeeenenee
nweeeeseeeseeseeswenwnenweswee
swswwneneneswenenwsenenenenenwnenwnwe
nwenwnwnwseswnwnwnwnwnwnwsenwnwnwnwnwnwnw
eswnwnweswsweseseswwswswnwseneswnenwswe
wnesewneswwneswwwwnwwwwsese
nwnenwnenenenenenenwneswnenwnenw
neswenenwswneneswnwee
wwnwwwwewwnwswnesewww
esenwnwswenenwnewswneswwenwswwnwswnww
swswwswnenwwswswnwseswswswwswswewsesw
nenwsenewnwswswneeswnwnenwnwnweenwnwne
neswwnwwwnwwwnenenwnwswwnwsenwnww
neneeneswenenenenenenee
swseweseneeeswwnenwswnwnwe
eewswweneweeneneeenenenenenenene
nwnwneneneneseneseswnenwnenwnwnenwnenene
enwnwenenwswswswnwsenwswswseswseenwe
eneneneneeeswneneenenenene
enwnenwwwsenwwwswneswnwwenwewww
neneneswnenewneneneeenwnenwnesewnene
seswsenwsesesenwewseswseseseseswsesenenwse
neneenewsesewneweeewseseenwneeene
nwwswwwsesenwwwsenewwnwnew
seseenesesesesesesesewesesee
nwwnwswswswseswwswseneswswswswswswswswe
wswwnwnwnwnwnwnwwnwnenwnwenwnwenwnw
seseswseneeswneswnewwswwwnwneesenene
nenwnwnwnenwnwnwnenwsenwnwnwnw
eswwwwwsewwnewswswwwswswneswww
esenwnwnweeewswneneswnwswnwswnenwnwnene
nenweseenwneenenwseeeneseene
newnwwsenwnwenwwwnwsewswnwnwenwww
newenenenenenenwenwswswswsene
nwsweswnwwnwewewwwenwwwwwnwwnw
sewnwsewwnwsenenwwww
swswnenwnwnewneswnewnweswsweswenwsenwse
wsweseeswnwseenewseneenee
eeeeeseeswnweeeenwseseewsese
sesesesenewsesesewesesesenwseseseene
sesewswseswsewseseseswweseeseseenese
esenwswwseseseseesesesenweseseseswe
nwnenenwnenwnwnenenesw
nwnenweneenwnenwnwnwswnenwneneswnenwnw
sewswswswswswnwswneeseswswswsw
swwswswswwwwneswneswwswswswnweswsw
neseswswesesewswwswswseswswnwseswnenese
nwswnwneewneweeseeseewewneneew
swseenenwwsenwnwnewneenwwewnwswe
swsweseswswswwwwswswswnewswsw
swnwwneneswswnwewwnwsenwenwnenwee
ewswseseneesewseneswsenwswseseswsese
eneeneeseswenwsewneeweenwnwese
swnwswswseswswswseseeswnwswswsweswnwsww
wwnwnwswnwsewwnwwnwwnwwnwsenwnee
eeseeeswneseneseeweneweseee
senesenwsesenwwsesesesesesesesesesesese
nwnewesewneswneeeeneeneeswnesenene
wesenwseswsweweenwnenwwnesese
nenwnwneeswneneeneneneswneneswneneenwnee
nwnwwsenwwnwnwwnwsenwnwenwnwnwwnwne
nwnwsenwnwsenwnwnwnenwnwwnesenwnwenwne
sewswweneesenenwneseswseswnweeeene
nwswnwnwnwnwwsenwnwwnwnwenwnwesenwnw
wwwwwwnenwwwwnesewwwse
swnenenenenenenwneneswnwneesenwnenewne
neneneswneneeneneneene
wswneseswswnewwnewswwwwwwwswsww
neeneseewnenwnwneseewneenenwwnenesww
enwseswseesesewnesweeeeneswsesenese
nwnwswnenenenwnwnwnenene
wswswswneswneswwswswsweseswswseswseswsw
sewseseesesweseneseseseseseswnwwsw
swseswswwnesenewnwwnweenweswwsenw
seseseswswseseseeseesesesesenwnwsesese
nenewnenwneswnwnese
seseneswseswswseseswswseswnwwswse
nwneeeeseseneseseeseeeeeeeeww
nwnwneenwswswnenwnenwnenwwneneenenwnwnw
nwnwenwnwnwsenwnwenwnwwnwnwnwswnwnwnw
wwnwwenesesewwwnewsesewnewwwe
wnwnwwwewnwseswwwwwnewnwswnwe
nwwwwswnesewwsewsenewnwnwsewnwnww
nweeeenwseeeseee
eneenewnwenewnwsesenewewswenenese
eswwsweswseswnwsenewnenwswseswwww
neswnesenenenwnenwenenwnwneneswneswnwne
enwseswnwnweesewnwseeseseeseseseseesw
wenwwwswnewswsesewwnwwnwnenewnw
nwwseseswswewwswwsewneswnenwnwesww
swnwnwnwswenenwnwnwnwsewenenenwnenesw
weneswwswswnwsweeesenenwsenwwwsw
eeseesenesesewnweseeenesweeeeew
eseweseseseesenwwsesenese
eneneneneneneneneeenenenenenwsw
esenwnweswenenwnwswnwwnewneenewnww
eeneneneeeeswneneenwsew
seweeseesenewswsenwewwneeeeee
newnwnwenwwnenesenewsenewswnweese
neswwwswswswneww
seswseswseneswseswswnewneswswswswsenenw
eneeneeeenwswneneeswnweenwseneswnene
neswseeswseseswswsewsese
wnewwswwneswswwenewswswwwswwnene
newswseswnwnwnwnenwnwnwnwnwnesenwne
neewswseswswnwswswseneswswswswswseswsesw
nwwneenwwwwsenwwseswenwnwswwnenw
wwwenwwnwnwwnwnwnwe
esesewsesesesesesenwsenwesenwswswswee
nwsesesenweseswseseseseswsesewseseenwse
newnwnwnenwswswwwnwwwnwwnwwnenwsw
swsewsenwseseseswwseseneesweswswsese
neeenweseeeeneswneeeeweee
nwenwnwnwnenwwnwnenenwnw
wwsewwenewwwwwwwsewwwnww
neneenesweneeneenwnenwneneseseeee
eswseneseseseeeeeeeseenwsewsese
nenenwswneeswnesenenewwnenenenwenwsese
nwwwwwewwswwswwnewwwwseeww
swswswswswswswseseswneeswswseneswwswwsww
nwneneswneeswenwseenweeneneewwwnee
swswswswneswwneseswwseswswswsw
swswseswneswwwswswwswsw
nwenweseesweeeeneeseeswseeesw
swswswsweswswnewwswwwswswwwnwswse
sewneseseswsesesesesewseseswnwseneswse
enenweeswsweswenwnwe
nenenwnwnenwnenwwnwswnwnenwsenenwne
neswseneswswnwwweneswnwseswswneewnese
nenweswsweeneeneswnweeneswneswee
wsenwseseseseeseseseseseseeseneswnese
swnenwwnwnwenwnwswnwnesenesesewnwnenenw
sweneeenenwenenenweeenenwsweeeswe
sewewnesesewnenwsesesesweseswswsesesw
neswswnenwneseseneneneneneneneswnenwnene
newnewweewwwnwseswwseswwewswww
senwseseseswswnesenweseswsewswsesesewsw
senenenenenenwnwnwsewnwnwenwnwnwwnene
nwnwenenwnwwneneswneneneneenwnwnwnese
seseseseseseswwneswseswesewswseswnwse
nenwnwnenwenenweswneneswweenwneneswnwnw
swnwseswewnewnesesesesesesesee
seswnenwwwewseneswswsenweneswnenenwe"""

input_str = """sesenwnenenewseeswwswswwnenewsewsw
neeenesenwnwwswnenewnwwsewnenwseswesw
seswneswswsenwwnwse
nwnwneseeswswnenewneswwnewseswneseene
swweswneswnenwsewnwneneseenw
eesenwseswswnenwswnwnwsewwnwsene
sewnenenenesenwsewnenwwwse
wenwwweseeeweswwwnwwe
wsweesenenewnwwnwsenewsenwwsesesenwne
neeswseenwwswnwswswnw
nenwswwsewswnenenewsenwsenwnesesenew
enewnwewneswsewnwswenweswnenwsenwsw
sweneswneswneneenwnewenewwneswswnese
swwesenesewenwneswnwwneseswwne
enesenwswwswneneswsenwnewswseenwsese
wnwnesenesenenwwnenwsewesewsesesew
nenewswnwewswnenesenwnesewesw
eneswnwswnwsenenwnwnwwseeswneewsenese
neswnwewnwnwseenwseesewsenwsweewe
wseweeenwnesenwwwswnew"""

import sys
import numpy as np
np.set_printoptions(threshold=sys.maxsize)

from collections import defaultdict

def process_line(line):
  directions = defaultdict((lambda: 0))
  direction = ""
  for char in line:
    if direction == "":
      if char == "e" or char == "w":
        directions[char] += 1
      else:
        direction += char
    else:
      direction += char
      directions[direction] += 1
      direction = ""
  
  return directions

def remove_redundancies(directions):
  if directions["sw"] > 0 and directions["nw"] > 0:
    smaller = min(directions["sw"], directions["nw"])
    directions["sw"] -= smaller
    directions["nw"] -= smaller
    directions["w"] += smaller

  if directions["se"] > 0 and directions["ne"] > 0:
    smaller = min(directions["se"], directions["ne"])
    directions["se"] -= smaller
    directions["ne"] -= smaller
    directions["e"] += smaller
 
  if directions["nw"] > 0 and directions["e"] > 0:
    smaller = min(directions["nw"], directions["e"])
    directions["nw"] -= smaller
    directions["e"] -= smaller
    directions["ne"] += smaller

  if directions["se"] > 0 and directions["w"] > 0:
    smaller = min(directions["se"], directions["w"])
    directions["se"] -= smaller
    directions["w"] -= smaller
    directions["sw"] += smaller

  if directions["ne"] > 0 and directions["w"] > 0:
    smaller = min(directions["ne"], directions["w"])
    directions["ne"] -= smaller
    directions["w"] -= smaller
    directions["nw"] += smaller

  if directions["sw"] > 0 and directions["e"] > 0:
    smaller = min(directions["sw"], directions["e"])
    directions["sw"] -= smaller
    directions["e"] -= smaller
    directions["se"] += smaller

  if directions["nw"] > 0 and directions["se"] > 0:
    smaller = min(directions["nw"], directions["se"])
    directions["nw"] -= smaller
    directions["se"] -= smaller

  if directions["sw"] > 0 and directions["ne"] > 0:
    smaller = min(directions["sw"], directions["ne"])
    directions["sw"] -= smaller
    directions["ne"] -= smaller

  if directions["w"] > 0 and directions["e"] > 0:
    smaller = min(directions["w"], directions["e"])
    directions["w"] -= smaller
    directions["e"] -= smaller

  return directions

def reconstruct_str(reduced_directions):
  reconstructed = ""
  reconstructed += reduced_directions["w"] * "w"
  reconstructed += reduced_directions["nw"] * "nw"
  reconstructed += reduced_directions["ne"] * "ne"
  reconstructed += reduced_directions["e"] * "e"
  reconstructed += reduced_directions["se"] * "se"
  reconstructed += reduced_directions["sw"] * "sw"

  return reconstructed

lines = input_str.splitlines()

str_dict = defaultdict((lambda: 0))
for line in lines:
  str_dict[reconstruct_str(remove_redundancies(remove_redundancies(process_line(line))))] += 1

black_tile_dicts = []

for key, value in str_dict.items():
  if value %2 == 1:
    black_tile_dicts.append(process_line(key))

print(black_tile_dicts)

hexagonal_grid = np.zeros((300,300))

def get_coords(tile_dict):
  x = 0
  y = 0
  
  y += tile_dict["w"]
  y -= tile_dict["e"]
  x += tile_dict["nw"]
  y += tile_dict["nw"]
  x += tile_dict["ne"]
  x -= tile_dict["sw"]
  x -= tile_dict["se"]
  y -= tile_dict["se"]

  return 150+x,150+y

for black_tile in black_tile_dicts:
  hexagonal_grid[get_coords(black_tile)] = 1

def get_adjacent(state, i, j):
  if i == 0:
    if j == 0:
      return state[i:i+2, j:j+2].sum() - state[i, j]
    elif j == state.shape[1]-1:
      return state[i:i+2, j-1:j+1].sum() - state[i, j] - state[i+1, j-1]
    else:
      return state[i:i+2, j-1:j+2].sum() - state[i, j] - state[i+1, j-1]
  elif i == state.shape[0]-1:
    if j == 0:
      return state[i-1:i+1, j:j+2].sum() - state[i, j] - state[i-1, j+1]
    elif j == state.shape[1]-1:
      return state[i-1:i+1, j-1:j+1].sum() - state[i, j]
    else:
      return state[i-1:i+1, j-1:j+2].sum() - state[i, j] - state[i-1, j+1]
  else:
    if j == 0:
      return state[i-1:i+2, j:j+2].sum() - state[i, j] - state[i-1, j+1]
    elif j == state.shape[1]-1:
      return state[i-1:i+2, j-1:j+1].sum() - state[i, j] - state[i+1, j-1]
    else:
      return state[i-1:i+2, j-1:j+2].sum() - state[i, j] - state[i-1, j+1] - state[i+1, j-1]


def evolve_state(state):
  new_state = np.zeros(state.shape)
  for i in range(new_state.shape[0]):
    for j in range(new_state.shape[1]):
      adjacent_tiles = get_adjacent(state, i, j)

      if (adjacent_tiles==0 or adjacent_tiles > 2) and state[i,j] == 1:
        new_state[i,j] = 0
      elif (adjacent_tiles==2) and state[i,j] == 0:
        new_state[i,j] = 1
      else:
        new_state[i,j] = state[i,j]

  return new_state

def print_array(array):
  for i in range(array.shape[0]):
    line = ""
    for j in range(array.shape[1]):
      if array[i,j] == 1:
        line += "#"
      else:
        line += "."
    print(line)


for i in range(100):
  print(i)
  hexagonal_grid = evolve_state(hexagonal_grid)


print(hexagonal_grid.sum())